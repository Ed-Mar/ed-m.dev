<!doctype html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=https://ed-m.dev/css/style.css><link rel=stylesheet href=https://ed-m.dev/css/single-page.css><title>Circular imports and GORM | 211230</title></head><body><nav class=navBar><ul><a href=/>Ed-M.Dev</a>
<a href=/notes>Notes</a>
<a href=/about>About</a></ul></nav><div class="main container single"><div class=single-page-content-container><div class=single-page-header><h2>Circular imports and GORM | 211230</h2><time>Thu, Dec 30, 2021</time><div class=single-page-project><h3><a href=/notes/projects/conduit>Project - Conduit</a></h3></div><div class=tags-container><div class=tag-list-item><a href=/tags/go>Go</a></div><div class=tag-list-item><a href=/tags/gorm>Gorm</a></div></div></div><br><div class=single-page-content><h1 id=211230>211230</h1><h2 id=circular-imports-and-gorm>Circular imports and GORM</h2><p>GORM leads it self to putting you in a circular import loop by design and I have come to learn that from trying to add this temp user struct due to them being many to many</p><p><img src=https://i.imgur.com/5p8l2pA.png alt="Had to go back and updo some things to get this back "></p><p>So each server is going to have many users and have each user is going to have many servers (in theory)</p><p><img src=https://i.imgur.com/CtYQ7lF.png alt="Users Many2Many"></p><p>But I did deem them close enough together in scope to be in the same package like channels and servers.</p><p>which leads to the user needing the server to define user and vise versa.</p><p><img src=https://i.imgur.com/GzSuQz2.png alt="doom linking"></p><p><img src=https://i.imgur.com/S8vNgWF.png alt="Loop de loop">
and in go that is a no go.</p><p>So what do.
There are few options</p><ul><li>interface your way out of<ul><li><img src=https://i.imgur.com/j1bmm1b.png alt=https://jogendra.dev/import-cycles-in-golang-and-how-to-deal-with-them></li><li>Which doesn&rsquo;t make to much since to me for some reason</li></ul></li><li>Autonomous structure passing<ul><li>Which mite work but not positive and seems kinda hacky</li></ul></li><li>Mess with the project structure <strong>some more</strong>.<ul><li>SO I am going to move all the things into there packages(channels, servers,messages, and users)</li><li>Does this fix the problem Nope, but I will also stop calling the object it self and just call ID of the associated item.( I already played with this in the Channel)<ul><li>Why this <a href=https://stackoverflow.com/questions/20380333/cyclic-dependencies-and-interfaces/20394211#20394211>Stackover Flow wall of text</a></li><li><img src=https://i.imgur.com/nEyC1VD.png alt="Some Text from that link "></li></ul></li></ul></li></ul><h3 id=how-did-i-not-see-this-coming>How did I not see this coming?</h3><p>I did know about circular imports, but just didn&rsquo;t think about it until I had had already done it. The GORM documentation did help, but its still on me but here:
<img src=https://i.imgur.com/LOM7hhG.png alt="Do you see it "></p><p>Okay here(above) do you see it? They are in the same file. I just filtered that out in my head.</p><p>Thought I just share that. I would like to move away from GORM at some point cause it&rsquo;s not the fastest performance wise, but until I get closer to a finalized data model i am going to lean on it to save some time</p></div></div></div></body><footer><hr>Author <a href=https://ed-m.dev/about>Edward M- </a>| Framework <a href=https://gohugo.io/>Hugo</a></footer></html>